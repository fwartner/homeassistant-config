action:
- choose:
  - conditions:
    - condition: trigger
      id: create
    - condition: not
      conditions:
      - condition: template
        value_template: '{{ trigger.event.data.service_data.message == ''clear_notification''
          }}'
    sequence:
    - data:
        message: '{{ trigger.event.data.service_data.message }}'
        notification_id: '{{ trigger.event.data.service_data.data.tag }}'
        title: '{{ trigger.event.data.service_data.title }}'
      service: persistent_notification.create
  - conditions:
    - condition: trigger
      id: create-ai
    - condition: not
      conditions:
      - condition: template
        value_template: '{{ trigger.event.data.service_data.message == ''clear_notification''
          }}'
    sequence:
    - data:
        agent_id: conversation.chatgpt_butler
        language: german
        text: Briefly tell me that my {{ trigger.event.data.service_data.message }}
          in a country accent and please in german
      response_variable: generated_content
      service: conversation.process
    - data:
        data:
          tag: '{{ trigger.event.data.service_data.data.tag }}'
        message: '{{ generated_content[''text''] }}'
        title: '{{ trigger.event.data.service_data.title }}'
      service: notify.all_devices
  - conditions:
    - condition: trigger
      id: create-ai
    - condition: template
      value_template: '{{ trigger.event.data.service_data.message == ''clear_notification''
        }}'
    sequence:
    - data:
        data:
          tag: '{{ trigger.event.data.service_data.data.tag }}'
        message: clear_notification
      service: notify.all_devices
  - conditions:
    - condition: template
      value_template: '{{ trigger.event.data.service_data.message == ''clear_notification''
        }}'
    sequence:
    - data:
        notification_id: '{{ trigger.event.data.service_data.data.tag }}'
      service: persistent_notification.dismiss
alias: Alert to Persistent
description: ''
id: '1818561693469'
mode: queued
trigger:
- event_data:
    domain: notify
    service: all_devices
  event_type: call_service
  id: create
  platform: event
- event_data:
    domain: notify
    service: home_ai
  event_type: call_service
  id: create-ai
  platform: event
