var e={version:"Version"},a={common:e};const t={en:Object.freeze({__proto__:null,common:e,default:a})};const l=(e,...a)=>{console.info(`%c  DEFAULT-DASHBOARD \n%c  ${e}   `,"color: orange; font-weight: bold; background: black","font-weight: bold;",...a)},n={defaultPanel:"",isDefaultPanelManaged:""};Object.keys(n).forEach((e=>{n[e]=e}));class s{constructor(e){this.getDashboards=async()=>this.hass.callWS({type:"lovelace/dashboards/list"}),this.createInputBoolean=async()=>{const e=await this.hass.callWS({type:"input_boolean/create",name:"Default Dashboard",initial:!0});return console.log(e),e},this.createInputSelect=async()=>{const e=await this.getDashboards().then((e=>e.filter((e=>!e.require_admin)).flatMap((e=>e.url_path)))),a=await this.hass.callWS({type:"input_select/create",name:"Default Dashboard",options:["lovelace",...e,"refresh"],initial:"lovelace"});return console.log(a),a},this.getStorageSettings=async()=>({defaultPanel:localStorage.getItem(n.defaultPanel),isDefaultPanelManaged:localStorage.getItem(n.isDefaultPanelManaged)}),this.setDefaultPanel=async e=>{localStorage.setItem(n.defaultPanel,e),localStorage.setItem(n.isDefaultPanelManaged,"true")},this.disable=async()=>{localStorage.setItem(n.isDefaultPanelManaged,"false")},this.enable=async()=>{localStorage.setItem(n.isDefaultPanelManaged,"true")},this.hass=e}}l(`${function(e,a="",l=""){const n=(localStorage.getItem("selectedLanguage")||"en").replace(/['"]+/g,"").replace("-","_");let s;try{s=e.split(".").reduce(((e,a)=>e[a]),t[n])}catch(a){s=e.split(".").reduce(((e,a)=>e[a]),t.en)}return void 0===s&&(s=e.split(".").reduce(((e,a)=>e[a]),t.en)),""!==a&&""!==l&&(s=s.replace(a,l)),s}("common.version")} 1.0.10`);let o;const i=async()=>{const e=await o.getDashboards(),a={};return e.forEach((e=>{a[e.url_path]=!0})),a},c=async e=>!(!e||!await(async()=>null===(await o.getStorageSettings()).isDefaultPanelManaged&&(await o.enable(),!0))())&&(l("Default Dashboard Enabled"),!0);(async()=>{for(;void 0===customElements.get("home-assistant");)await new Promise((e=>window.setTimeout(e,100)));const e=document.getElementsByTagName("home-assistant")[0].hass;o=new s(e),window.addEventListener("hass-default-panel",(e=>{"lovelace"===e.detail.defaultPanel?o.enable():o.disable()}));const{url:a,enabled:t}=(e=>{const a=e.states["input_select.default_dashboard"]?.state,t=e.states["input_boolean.default_dashboard"]?.state;return void 0!==a&&void 0!==t||(void 0===a&&(o.createInputSelect(),l("Created a Dropdown helper with the id `input_select.default_dashboard`")),void 0===t&&(o.createInputBoolean(),l("Created a Toggle helper with the id `input_boolean.default_dashboard`"))),{url:a,enabled:"on"===t}})(e);if(a){if("refresh"===a){l("Setting dropdown options");const a=await i();return await(async(e,a)=>e.callService("input_select","set_options",{options:a},{entity_id:"input_select.default_dashboard"}))(e,["lovelace",...Object.keys(a),"refresh"]),void await(async(e,a)=>e.callService("input_select","select_option",{option:a},{entity_id:"input_select.default_dashboard"}))(e,"lovelace")}await c(t),await(async e=>{const a=`"${e}"`,t=await o.getStorageSettings(),n="false"===t.isDefaultPanelManaged||null===t.isDefaultPanelManaged,s=await i();n||s[e]&&t.defaultPanel!==a&&(l(`Setting default panel to ${a}`),await o.setDefaultPanel(a),location.replace("/"))})(a)}})();
