- id: '1669632865548'
  alias: 'Flur: Licht an wenn Tür auf'
  description: ''
  triggers:
  - type: opened
    device_id: d62a1a0d66691a20f54abe4cdfb6d6c9
    entity_id: 9a9c1257a5aa466af0aaed31c0e7735d
    domain: binary_sensor
    trigger: device
    for:
      hours: 0
      minutes: 0
      seconds: 1
  conditions:
  - condition: and
    conditions:
    - condition: sun
      after: sunset
      before: sunrise
      after_offset: '1'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  actions:
  - type: turn_on
    device_id: 4b04528f90d6106276926f279e2d4cb6
    entity_id: 95eab0e0f096de60d69cc6204752c455
    domain: light
    brightness_pct: 60
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - type: turn_off
    device_id: 4b04528f90d6106276926f279e2d4cb6
    entity_id: 95eab0e0f096de60d69cc6204752c455
    domain: light
  mode: single
- id: '1670802573901'
  alias: Taster Schlafzimmer Actions
  description: ''
  use_blueprint:
    path: Drafted/aqara-buttons-all-in-one-zigbee2mqtt.yaml
    input:
      action_sensor: sensor.aqara_taster_schlafzimmer_action
      double_action:
      - if:
        - condition: state
          entity_id: input_boolean.wartung
          state: 'off'
        then:
        - parallel:
          - service: script.3_minuten_bettzeit
            data: {}
          - service: script.10_minuten_boost_wohnzimmer
            data: {}
      single_action:
      - if:
        - condition: state
          entity_id: input_boolean.wartung
          state: 'off'
        then:
        - if:
          - condition: or
            conditions:
            - condition: state
              entity_id: cover.rollos_schlafzimmer
              state: closing
            - condition: state
              entity_id: cover.rollos_schlafzimmer
              state: closed
          then:
          - service: cover.open_cover
            data: {}
            target:
              entity_id: cover.rollos_schlafzimmer
          else:
          - if:
            - condition: or
              conditions:
              - condition: state
                entity_id: cover.rollos_schlafzimmer
                state: opening
              - condition: state
                entity_id: cover.rollos_schlafzimmer
                state: open
            then:
            - service: cover.close_cover
              data: {}
              target:
                entity_id: cover.rollos_schlafzimmer
- id: '1674670778068'
  alias: Kaffeemaschine
  description: Fü vier Stunden
  trigger:
  - platform: time
    at: 07:30:00
    id: kaffeemaschineOn
  - platform: time
    at: '11:30:00'
    id: kaffeemaschineOff
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: sensor.people_home
      state: '1'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - kaffeemaschineOn
      sequence:
      - type: turn_on
        device_id: 7641a6d433b2e26a0c7d94ad413df030
        entity_id: ea900cc1cb4a987a44c517bbb1816c5c
        domain: switch
    - conditions:
      - condition: trigger
        id:
        - kaffeemaschineOff
      sequence:
      - type: turn_off
        device_id: 7641a6d433b2e26a0c7d94ad413df030
        entity_id: ea900cc1cb4a987a44c517bbb1816c5c
        domain: switch
  mode: single
- id: '1686557247104'
  alias: Ventilator
  description: 'An: Wenn über 26 Grad

    Aus: Wenn unter 24 Grad'
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.wohnzimmer_temperature
    above: 25
    id: fanOn
  - platform: numeric_state
    entity_id:
    - sensor.wohnzimmer_temperature
    id: fanOff
    below: 23
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.ventilator
      state: 'on'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  action:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: trigger
          id:
          - fanOn
        - condition: time
          weekday:
          - mon
          - tue
          - wed
          - thu
          - fri
          - sat
          - sun
          before: '22:00:00'
          after: 07:00:00
          enabled: false
      sequence:
      - service: fan.turn_on
        data:
          percentage: 60
        target:
          entity_id: fan.ventilator_wohnzimmer
    - conditions:
      - condition: trigger
        id:
        - fanOff
      sequence:
      - service: fan.turn_off
        data: {}
        target:
          entity_id: fan.ventilator_wohnzimmer
  mode: single
- id: '1686661353814'
  alias: Rollos runter wenn 26 Grad auf Balkon
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.balkon_temperature
    above: 26
    id: tooHotBalconyOn
  - platform: numeric_state
    entity_id:
    - sensor.balkon_temperature
    id: tooHotBalconyOff
    below: 23
  condition:
  - condition: and
    conditions:
    - condition: time
      before: '21:00:00'
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
      after: 09:00:00
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - tooHotBalconyOn
      sequence:
      - service: cover.close_cover
        data: {}
        target:
          entity_id:
          - cover.rollos_schlafzimmer
    - conditions:
      - condition: trigger
        id:
        - tooHotBalconyOff
      sequence:
      - service: input_boolean.turn_off
        target:
          entity_id:
          - input_boolean.zu_warm
        data: {}
      - service: cover.open_cover
        target:
          entity_id:
          - cover.rollos_schlafzimmer
        data: {}
  mode: single
- id: '1691151128778'
  alias: Nachtlicht Küche
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.hlk_ld2410_7137_anwesenheit
    from: 'off'
    to: 'on'
    id: kucheOn
    trigger: state
  - entity_id:
    - binary_sensor.hlk_ld2410_7137_anwesenheit
    from: 'on'
    to: 'off'
    id: kucheOff
    trigger: state
  conditions:
  - condition: and
    conditions:
    - condition: sun
      after: sunset
      after_offset: '1'
      before: sunrise
      before_offset: '1'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - kucheOn
      sequence:
      - type: turn_on
        device_id: 7e56df9d6385100a6089783f6de066d7
        entity_id: 36aeda22c66e308e67721d47b46bf669
        domain: light
        brightness_pct: 30
    - conditions:
      - condition: trigger
        id:
        - kucheOff
      sequence:
      - type: turn_off
        device_id: 7e56df9d6385100a6089783f6de066d7
        entity_id: 36aeda22c66e308e67721d47b46bf669
        domain: light
  mode: single
- id: '1691320563612'
  alias: Rollos schließen wenn zu hell
  description: ''
  triggers:
  - type: illuminance
    device_id: cc409c26cddb1137902b367f0bbcc342
    entity_id: fdf41f9caeca9372e6285dca0cc7d60f
    domain: sensor
    trigger: device
    id: wohnzimmerRollosOn
    above: 10000
  - type: illuminance
    device_id: cc409c26cddb1137902b367f0bbcc342
    entity_id: fdf41f9caeca9372e6285dca0cc7d60f
    domain: sensor
    trigger: device
    id: wohnzimmerRollosOff
    below: 500
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.zu_warm
      state: 'off'
    - condition: state
      entity_id: input_boolean.guestmode
      state: 'off'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
    - condition: state
      entity_id: input_boolean.rollos_wohnzimmer
      state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - wohnzimmerRollosOn
      sequence:
      - data: {}
        target:
          entity_id:
          - cover.ikea_rollo_links_wohnzimmer
          - cover.ikea_rollo_rechts_wohnzimmer
        action: cover.close_cover
    - conditions:
      - condition: trigger
        id:
        - wohnzimmerRollosOff
      sequence:
      - data: {}
        target:
          entity_id:
          - cover.ikea_rollo_links_wohnzimmer
          - cover.ikea_rollo_rechts_wohnzimmer
        action: cover.open_cover
    - conditions:
      - condition: trigger
        id:
        - kucheRollosOn
      sequence: []
  mode: single
- id: '1691358813636'
  alias: Nachtlicht Flur
  description: 20%
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.hlk_flur_belegung
    to: 'on'
    id: flurOn
  - platform: state
    entity_id:
    - binary_sensor.hlk_flur_belegung
    to: 'off'
    from: 'on'
    id: flurOff
  condition:
  - condition: and
    conditions:
    - condition: sun
      after: sunset
      after_offset: '1'
      before: sunrise
      before_offset: '1'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - flurOn
      sequence:
      - type: turn_on
        device_id: 1e56c698587f52128871b8ba472cfc47
        entity_id: 2c70b1a119850621e0cd9a85759fca40
        domain: light
        brightness_pct: 30
    - conditions:
      - condition: trigger
        id:
        - flurOff
      sequence:
      - type: turn_off
        device_id: 1e56c698587f52128871b8ba472cfc47
        entity_id: 2c70b1a119850621e0cd9a85759fca40
        domain: light
  mode: single
- id: '1691741828322'
  alias: Ankommen
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.aqara_contact_wohnungstur_contact
    from: 'on'
    to: 'off'
    enabled: true
    for:
      hours: 0
      minutes: 0
      seconds: 2
    id: doorOpenOn
    trigger: state
  - entity_id:
    - sensor.people_home
    to: '1'
    id: anyoneHomeOn
    trigger: state
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.guestmode
      state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - anyoneHomeOn
      sequence:
      - data: {}
        target:
          device_id: 9d14dca47a5773d55c5f7f9d16c58476
        action: switch.turn_on
      - action: alarmo.disarm
        metadata: {}
        data:
          entity_id: alarm_control_panel.alarmo
          code: '8182'
    - conditions:
      - condition: trigger
        id:
        - doorOpenOn
      - condition: template
        value_template: '{{ is_state_attr(''media_player.spotify_florian'', ''source'',
          ''iPhone'') }}'
        enabled: true
      - condition: template
        value_template: '{{ is_state(''media_player.spotify_florian'', ''playing'')
          }}'
        enabled: true
      sequence:
      - data:
          title: "Willkommen Zuhause \U0001F3E0"
          message: Ich habe die Musik von deinem iPhone auf Sonos Ray gestellt
        action: notify.florian_notify
      - data:
          source: Spotify Connect
        target:
          entity_id: media_player.sonos_ray_wohnzimmer
        action: media_player.select_source
      - data:
          source: Sonos Ray
        target:
          entity_id: media_player.spotify_florian
        action: media_player.select_source
      - data: {}
        target:
          entity_id: media_player.sonos_ray_wohnzimmer
        action: media_player.media_play
    - conditions:
      - condition: trigger
        id:
        - doorOpenOn
      - condition: template
        value_template: '{{ (as_timestamp(now()) - as_timestamp(states.person.florian_wartner.last_changed))
          < 10 }}'
        enabled: true
      sequence:
      - metadata: {}
        data:
          volume_level: 0.25
        target:
          device_id: 5d251a0a20f76a8251bbdb9e1b1b0178
        action: media_player.volume_set
      - metadata: {}
        data: {}
        action: script.willkommen_florian
  mode: single
- id: '1691769668517'
  alias: 'Jonas: Zähneputzen Starten'
  description: ''
  use_blueprint:
    path: Drafted/aqara-buttons-all-in-one-zigbee2mqtt.yaml
    input:
      action_sensor: sensor.aqara_taster_badezimmer_action
      single_action:
      - if:
        - condition: state
          entity_id: input_boolean.wartung
          state: 'off'
        then:
        - condition: state
          entity_id: input_boolean.jonas_ist_da
          state: 'on'
        - service: script.zahneputzen
          data: {}
        - condition: time
          weekday:
          - fri
          - sat
          before: '20:00:00'
- id: '1691786451171'
  alias: Nachtlicht Badezimmer
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.mmwave_badezimmer
    to: 'on'
    id: badezimmerOn
    trigger: state
    for:
      hours: 0
      minutes: 0
      seconds: 2
  - entity_id:
    - binary_sensor.mmwave_badezimmer
    to: 'off'
    id: badezimmerOff
    trigger: state
    for:
      hours: 0
      minutes: 0
      seconds: 5
  conditions:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  actions:
  - if:
    - condition: sun
      before: sunrise
      before_offset: '1'
      after: sunset
      after_offset: '1'
    then:
    - choose:
      - conditions:
        - condition: trigger
          id:
          - badezimmerOn
        sequence:
        - data:
            brightness_pct: 30
          target:
            entity_id: light.decke_badezimmer
          action: light.turn_on
      - conditions:
        - condition: trigger
          id:
          - badezimmerOff
        sequence:
        - metadata: {}
          data: {}
          target:
            entity_id: input_boolean.klo_besetzt
          action: input_boolean.turn_off
        - if:
          - condition: and
            conditions:
            - condition: or
              conditions:
              - condition: sun
                before: sunrise
                after: sunset
                after_offset: '1'
                enabled: true
              - condition: state
                entity_id: input_boolean.guestmode
                state: 'off'
                enabled: false
          then:
          - data: {}
            target:
              device_id: 6e5322a0a9b03a5d8858879bbead49bf
            action: light.turn_off
  mode: single
- id: '1692084370120'
  alias: Verlassen
  description: ''
  triggers:
  - entity_id:
    - sensor.people_home
    to: '0'
    id: anyoneHomeOff
    trigger: state
  conditions:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - anyoneHomeOff
      sequence:
      - data: {}
        target:
          entity_id: light.alle_lampen
        action: light.turn_off
      - data: {}
        target:
          entity_id:
          - switch.alle_steckdosen
        action: switch.turn_off
      - action: alarmo.arm
        metadata: {}
        data:
          mode: away
          skip_delay: true
          force: true
          entity_id: alarm_control_panel.alarmo
  mode: single
- id: '1692134639284'
  alias: Türklingel
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.nuki_haustur_ring_action
    to: 'on'
    id: ringOn
    trigger: state
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.nicht_storen
      state: 'off'
    - condition: numeric_state
      entity_id: sensor.people_home
      above: 0
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  actions:
  - parallel:
    - action: notify.mobile_app_mac_mini_von_florian
      data:
        title: Es hat geklingelt!
        message: Jemand scheint an der Tür zu sein…
    - choose:
      - conditions:
        - condition: and
          conditions:
          - condition: trigger
            id:
            - ringOn
          - condition: numeric_state
            entity_id: sensor.people_home
            below: 1
        sequence:
        - data:
            message: Scheinbar hat jemand an der Tür geklingelt.
            title: Jemand hat an der Tür geklingelt..
          action: notify.mobile_app_iphone_von_florian
      - conditions:
        - condition: and
          conditions:
          - condition: trigger
            id:
            - ringOn
          - condition: numeric_state
            entity_id: sensor.people_home
            above: 0
        sequence:
        - parallel:
          - repeat:
              count: '3'
              sequence:
              - data:
                  color_name: gold
                target:
                  device_id: 81a05f4ea38ce123a73f5f66b8e0e3c1
                action: light.turn_on
              - delay:
                  hours: 0
                  minutes: 0
                  seconds: 1
                  milliseconds: 0
              - data: {}
                target:
                  device_id: 81a05f4ea38ce123a73f5f66b8e0e3c1
                action: light.turn_off
              - delay:
                  hours: 0
                  minutes: 0
                  seconds: 1
                  milliseconds: 0
          - data:
              message: Jemand hat an der Tür geklingelt
            enabled: false
            action: notify.alexa_media_echo_show_wohnzimmer
          - metadata: {}
            data: {}
            action: script.awtrix_doorbell
      - conditions:
        - condition: trigger
          id:
          - ringOn
        sequence:
        - metadata: {}
          data:
            title: "\U0001F514 Klingeling!"
            message: Jemand hat an der Tür geklingelt
          action: notify.mobile_app_macbook_pro_von_florian
  mode: single
- id: '1692310400644'
  alias: Aufstehen
  description: ''
  triggers:
  - at: 08:30:00
    id: timeOn
    trigger: time
  conditions:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - timeOn
      sequence:
      - data: {}
        target:
          entity_id:
          - switch.dashboard_flur_bildschirm
          - switch.lenovo_tab_m10_bildschirm
        action: switch.turn_on
  mode: single
- id: '1693489965780'
  alias: Rollo Küche
  description: ''
  trigger:
  - platform: sun
    event: sunset
    offset: '1'
    id: coverKucheClose
  - platform: sun
    event: sunrise
    offset: '1'
    id: coverKucheOpen
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - coverKucheClose
      sequence:
      - service: cover.close_cover
        data: {}
        target:
          entity_id: cover.aqara_rollo_kuche
    - conditions:
      - condition: trigger
        id:
        - coverKucheOpen
      sequence:
      - service: cover.open_cover
        data: {}
        target:
          entity_id: cover.aqara_rollo_kuche
  mode: single
- id: a7c427e6-ce03-49eb-9a23-c5bbe7625aa4
  alias: Admin - Generate README.md
  description: ''
  trigger:
  - platform: time
    at: 05:00:00
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: readme.generate
    data: {}
  initial_state: true
- id: '1699291427370'
  alias: Speedtest
  description: Alle 2 Minuten
  trigger:
  - platform: time_pattern
    minutes: /2
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: script.1699263899938
    data: {}
  mode: single
- id: '1700299245684'
  alias: Taster Badezimmer
  description: ''
  use_blueprint:
    path: Drafted/aqara-buttons-all-in-one-zigbee2mqtt.yaml
    input:
      action_sensor: sensor.aqara_taster_badezimmer_action
      double_action:
      - if:
        - condition: state
          entity_id: input_boolean.wartung
          state: 'off'
        then:
        - service: script.duschen_vorbereiten
          data: {}
- id: '1700299340055'
  alias: Duschen vorbereiten
  description: ''
  use_blueprint:
    path: Drafted/aqara-buttons-all-in-one-zigbee2mqtt.yaml
    input:
      action_sensor: sensor.aqara_taster_badezimmer_action
      double_action:
      - if:
        - condition: state
          entity_id: input_boolean.wartung
          state: 'off'
        then:
        - service: script.duschen_vorbereiten
          data: {}
        - service: climate.set_hvac_mode
          data:
            hvac_mode: 'off'
          target:
            entity_id: climate.heizung_badezimmer
- id: '1701356043476'
  alias: Batterien
  description: ''
  use_blueprint:
    path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
    input:
      actions:
      - service: notify.home_ai
        data:
          message: Einige Batterien schein fast oder ganz leer zu sein. Guck doch
            mal nach.
          title: "\U0001FAAB Niedriger Batterie Status"
      day: 1
- id: '1701773191392'
  alias: Heizung Toggle
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.heizung_toggle
    to: 'off'
    id: alleHeizungenAus
    from: 'on'
  - platform: state
    entity_id:
    - input_boolean.heizung_toggle
    to: 'on'
    id: alleHeizungenAn
    from: 'off'
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - alleHeizungenAus
      sequence:
      - if:
        - condition: or
          conditions:
          - condition: state
            entity_id: climate.heizung_badezimmer
            state: heat
          - condition: state
            entity_id: climate.heizung_wohnzimmer
            state: heat
          - condition: state
            entity_id: climate.heizung_schlafzimmer
            state: heat
          - condition: state
            entity_id: climate.heizung_buro
            state: heat
        then:
        - service: climate.set_hvac_mode
          data:
            hvac_mode: 'off'
          target:
            device_id:
            - 90ee15e301be363c6e674cb006400119
            - afd3d4982d793f98224ce76064298198
            - a71ccaedb801d2e7e89232f60fea1706
            - 5106942131c1dfe9055cba838a26b47b
        - service: notify.home_ai
          data:
            title: ℹ️ Alle Heizungen ausgeschaltet
            message: Alle Heizungen wurden erfolgreich ausgeschaltet.
    - conditions:
      - condition: trigger
        id:
        - alleHeizungenAn
      sequence:
      - if: []
        then:
        - service: climate.set_hvac_mode
          data:
            hvac_mode: heat
        - service: notify.home_ai
          data:
            title: ℹ️ Alle Heizungen eingeschaltet
            message: Alle Heizungen wurden erfolgreich eingeschaltet.
  mode: single
- id: '1702645776967'
  alias: Bett Belegung
  description: ''
  trigger:
  - alias: Bett Rechts An
    platform: state
    entity_id:
    - binary_sensor.bett_proxy_sensor_bett_rechts
    from: 'off'
    to: 'on'
    id: bettRechtsAn
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - alias: Bett Links An
    platform: state
    entity_id:
    - binary_sensor.bett_proxy_sensor_bett_links
    from: 'off'
    to: 'on'
    id: bettLinksAn
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - alias: Bett Rechts Aus
    platform: state
    entity_id:
    - binary_sensor.bett_proxy_sensor_bett_rechts
    from: 'on'
    to: 'off'
    id: bettRechtsAus
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - alias: Bett Links Aus
    platform: state
    entity_id:
    - binary_sensor.bett_proxy_sensor_bett_links
    from: 'on'
    to: 'off'
    id: bettLinksAus
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - bettRechtsAn
      sequence:
      - service: input_boolean.turn_on
        target:
          entity_id: input_boolean.bett_rechts
        data: {}
      alias: Bett Rechts An
    - conditions:
      - condition: trigger
        id:
        - bettLinksAn
      sequence:
      - service: input_boolean.turn_on
        target:
          entity_id: input_boolean.bett_links
        data: {}
      alias: Bett Links An
    - conditions:
      - condition: trigger
        id:
        - bettRechtsAus
      sequence:
      - service: input_boolean.turn_off
        target:
          device_id: []
          area_id: []
          entity_id: input_boolean.bett_rechts
        data: {}
      alias: Bett Rechts Aus
    - conditions:
      - condition: trigger
        id:
        - bettLinksAus
      sequence:
      - service: input_boolean.turn_off
        target:
          device_id: []
          area_id: []
          entity_id: input_boolean.bett_links
        data: {}
      alias: Bett Links Aus
  mode: single
- id: '1702827571661'
  alias: Türen
  description: ''
  triggers:
  - entity_id: person.florian_wartner
    zone: zone.home
    event: enter
    id: zoneHomeOn
    trigger: zone
  - entity_id:
    - binary_sensor.nuki_haustur_ring_action
    to: 'on'
    id: nukiRingOn
    trigger: state
  - event_type: mobile_app_notification_action
    event_data:
      action: UNLOCK_HOUSE
    id: unlockHouse
    trigger: event
  - event_type: mobile_app_notification_action
    event_data:
      action: UNLOCK_APARTMENT
    id: unlockApartment
    trigger: event
  conditions:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: trigger
          id:
          - zoneHomeOn
          - nukiRingOn
      sequence:
      - data:
          message: Möchtest du die Tür öffnen?
          title: "\U0001F510 Türen öffnen"
          data:
            actions:
            - action: UNLOCK_HOUSE
              title: Haustür öffnen
              icon: sfsymbols:lock.open.fill
            - action: UNLOCK_APARTMENT
              title: Wohnungstür öffnen
              icon: sfsymbols:lock.open.fill
        action: notify.florian_notify
      alias: Notification Florian
    - conditions:
      - condition: trigger
        id:
        - unlockHouse
      sequence:
      - target:
          entity_id: lock.nuki_haustur_lock
        data: {}
        action: lock.open
      alias: Haustür Öffnen
    - conditions:
      - condition: trigger
        id:
        - unlockApartment
      sequence:
      - data: {}
        target:
          entity_id: lock.nuki_wohnungstur_lock
        action: lock.open
      alias: Wohnungstür Öffnen
  mode: single
- id: '1707472829981'
  alias: Wohnungstür (NFC Tag)
  description: ''
  triggers:
  - tag_id: 80174732-d4b2-4c77-9e71-a05ff997192a
    trigger: tag
  conditions:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  actions:
  - metadata: {}
    data: {}
    target:
      entity_id: lock.nuki_wohnungstur_lock
    action: lock.open
  mode: single
- id: '1710602590906'
  alias: BKW Steckdose Probleme
  description: ''
  trigger:
  - type: problem
    platform: device
    device_id: 25e8395680cf11660d43d6d06ecb2d14
    entity_id: f4693bd0130677bf399323ff19198c88
    domain: binary_sensor
    id: bkwIssueNotificationOverheating
  - type: problem
    platform: device
    device_id: 25e8395680cf11660d43d6d06ecb2d14
    entity_id: 6fa52c6272a0f11bbe8eb1e3937213d7
    domain: binary_sensor
    id: bkwIssueNotificationOverpowering
  - type: problem
    platform: device
    device_id: 25e8395680cf11660d43d6d06ecb2d14
    entity_id: 6b46f1be9a1f4a9af2ffe4adb2499125
    domain: binary_sensor
    id: bkwIssueNotificationOvervoltage
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: SWITCH_OFF_BKW
    id: bkwIssueNotificationEventListener
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.nicht_storen
      state: 'off'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - bkwIssueNotificationOverheating
        - bkwIssueNotificationOverpowering
        - bkwIssueNotificationOvervoltage
      sequence:
      - service: notify.home_ai
        data:
          message: Das BKW scheint zu überhitzen. Wie willst du vorgehen?
          title: ⚠️ Probleme mit dem BKW
          data:
            push:
              sound:
                name: default
                critical: 1
                volume: 1
            actions:
            - action: SWITCH_OFF_BKW
              title: Steckdose Abschalten
              icon: sfsymbols:line.horizontal.3.decrease.circle
    - conditions:
      - condition: trigger
        id:
        - bkwIssueNotificationEventListener
      sequence:
      - type: turn_off
        device_id: 25e8395680cf11660d43d6d06ecb2d14
        entity_id: c2b543703b09163eb220f8b8a0eb4830
        domain: switch
  mode: single
- id: '1711970118796'
  alias: 'BKW: Inverter Power'
  description: ''
  trigger:
  - platform: time
    at: sensor.sun_next_rising
    id: bkwInverterOn
  - platform: time
    at: '21:30:00'
    id: bkwInverterOff
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - bkwInverterOff
      sequence:
      - if: []
        then:
        - type: turn_off
          device_id: 25e8395680cf11660d43d6d06ecb2d14
          entity_id: c2b543703b09163eb220f8b8a0eb4830
          domain: switch
    - conditions:
      - condition: trigger
        id:
        - bkwInverterOn
      sequence:
      - type: turn_on
        device_id: 25e8395680cf11660d43d6d06ecb2d14
        entity_id: c2b543703b09163eb220f8b8a0eb4830
        domain: switch
  mode: single
- id: '1711970540815'
  alias: Küche Steckdosen Power Management
  description: ''
  triggers:
  - entity_id:
    - sensor.steckdose_waschmaschine_energy_power
    for:
      hours: 0
      minutes: 2
      seconds: 0
    id: washingMachineOffAfterTime
    to: '0'
    from:
    trigger: state
  - entity_id:
    - sensor.steckdose_spuhlmaschine_energy_power
    for:
      hours: 0
      minutes: 2
      seconds: 0
    id: dishWasherOffAfterTime
    to: '0'
    from:
    trigger: state
  conditions:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - washingMachineOffAfterTime
      sequence:
      - type: turn_off
        device_id: 3c45a70c459e2e66b166dca5891180c6
        entity_id: eb4d372310f986822d024a05f2007c03
        domain: switch
      - data:
          title: "\U0001F9FA Wäsche ist fertig"
          message: Die Wäsche ist fertig.
        action: notify.florian_notify
    - conditions:
      - condition: trigger
        id:
        - dishWasherOffAfterTime
      sequence:
      - type: turn_off
        device_id: 4a05cd597a16be48ba279a90d1ba5c18
        entity_id: 6a36fb96527589eaed3672a9978a3393
        domain: switch
      - data:
          title: "\U0001F37D️ Geschirr ist sauber"
          message: Spülmaschine ist fertig.
        action: notify.florian_notify
  mode: single
- id: '1712525174898'
  alias: Wecker
  description: ''
  triggers:
  - at: input_datetime.wecker
    enabled: true
    trigger: time
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.wecker_an_aus
      state: 'on'
    - condition: state
      entity_id: input_boolean.nicht_storen
      state: 'off'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  actions:
  - target:
      device_id: 3738295208de8496912ccf373503aa6c
    data:
      url: https://ha.wartner.cloud/dashboard-nspanel/1
    action: fully_kiosk.load_url
  - device_id: bb8a84cf268277f3d38063aee6ce698e
    domain: lock
    entity_id: 7b91d36587ba4469f26de8a280995404
    type: unlock
  - if:
    - condition: state
      entity_id: input_boolean.auto_wecker
      state: 'off'
    then:
    - metadata: {}
      data: {}
      target:
        entity_id: input_boolean.wecker_an_aus
      action: input_boolean.turn_off
  mode: single
- id: '1712829051695'
  alias: 'BKW: Maschinen laufen lassen Notification'
  description: ''
  triggers:
  - entity_id:
    - sensor.shelly_bkw_power
    for:
      hours: 0
      minutes: 5
      seconds: 0
    above: 330
    id: bkwSunPower
    trigger: numeric_state
  - event_type: mobile_app_notification_action
    event_data:
      action: IOS_BKW_WASCHMASCHINE_AN
    id: bkwIOSWMAn
    trigger: event
  - event_type: mobile_app_notification_action
    event_data:
      action: IOS_BKW_SPUELMASCHINE_AN
    id: bkwIOSSMAn
    trigger: event
  - event_type: mobile_app_notification_action
    event_data:
      action: IOS_BKW_ALLES_AN
    id: bkwIOSALLESAn
    trigger: event
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.nicht_storen
      state: 'off'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
    - condition: numeric_state
      entity_id: sensor.people_home
      above: 0.3
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - bkwSunPower
      sequence:
      - metadata: {}
        data:
          title: ☀️ Die Sonne scheint prächtig!
          message: Du erzeugst gerade so viel Energie, du könntest doch glatt die
            Waschmaschine oder die Spülmaschine laufen lassen! Soll ich die Steckdosen
            einschalten? (Ignoriere die Temperatur in der Küche)
          data:
            actions:
            - action: IOS_BKW_WASCHMASCHINE_AN
              title: Waschmaschine
              icon: sfsymbols:power
            - action: IOS_BKW_SPUELMASCHINE_AN
              title: Spühlmaschine
              icon: sfsymbols:power
            - action: IOS_BKW_ALLES_AN
              title: Beides
              icon: sfsymbols:power
        action: notify.florian_notify
    - conditions:
      - condition: trigger
        id:
        - bkwIOSWMAn
      sequence:
      - type: turn_on
        device_id: 3c45a70c459e2e66b166dca5891180c6
        entity_id: eb4d372310f986822d024a05f2007c03
        domain: switch
    - conditions:
      - condition: trigger
        id:
        - bkwIOSSMAn
      sequence:
      - type: turn_on
        device_id: 4a05cd597a16be48ba279a90d1ba5c18
        entity_id: 6a36fb96527589eaed3672a9978a3393
        domain: switch
    - conditions:
      - condition: trigger
        id:
        - bkwIOSALLESAn
      sequence:
      - type: turn_on
        device_id: 4a05cd597a16be48ba279a90d1ba5c18
        entity_id: 6a36fb96527589eaed3672a9978a3393
        domain: switch
      - type: turn_on
        device_id: 3c45a70c459e2e66b166dca5891180c6
        entity_id: eb4d372310f986822d024a05f2007c03
        domain: switch
  mode: single
- id: '1712905210678'
  alias: Neues Gerät gefunden (Notification)
  description: ''
  trigger:
  - platform: event
    event_type: device_tracker_new_device
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.nicht_storen
      state: 'off'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  action:
  - service: notify.home_ai
    data:
      title: Neues Gerät gefunden
      message: 'Home Assistant hat ein neues Gerät gefunden:             {{trigger.event.data.entity_id}}'
  mode: single
- id: '1713180340302'
  alias: Fenster und Türen Alert
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.aqara_contact_balkontur_contact
    - binary_sensor.eve_contact_schlafzimmer_fenster_rechts
    id: windowOpenOn
    from: 'off'
    to: 'on'
  - platform: state
    entity_id:
    - binary_sensor.aqara_contact_balkontur_contact
    - binary_sensor.eve_contact_schlafzimmer_fenster_rechts
    id: windowOpenOff
    from: 'on'
    to: 'off'
  - platform: state
    entity_id:
    - binary_sensor.aqara_contact_badezimmer_contact
    - binary_sensor.aqara_contact_kinderzimmer_contact
    - binary_sensor.aqara_contact_schlafzimmer_contact
    - binary_sensor.aqara_contact_wohnungstur_contact
    - binary_sensor.aqara_contact_wohnzimmer_contact
    id: doorOpenOn
    from: 'off'
    to: 'on'
  - platform: state
    entity_id:
    - binary_sensor.aqara_contact_badezimmer_contact
    - binary_sensor.aqara_contact_kinderzimmer_contact
    - binary_sensor.aqara_contact_schlafzimmer_contact
    - binary_sensor.aqara_contact_wohnungstur_contact
    - binary_sensor.aqara_contact_wohnzimmer_contact
    id: doorOpenOff
    from: 'on'
    to: 'off'
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
    - condition: numeric_state
      entity_id: sensor.people_home
      below: 1
    - condition: state
      entity_id: input_boolean.nicht_storen
      state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - windowOpenOn
      sequence:
      - service: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.windows_open
    - conditions:
      - condition: trigger
        id:
        - windowOpenOff
      sequence:
      - service: input_boolean.turn_off
        target:
          entity_id:
          - input_boolean.windows_open
        data: {}
    - conditions:
      - condition: trigger
        id:
        - doorOpenOn
      sequence:
      - service: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.doors_open
    - conditions:
      - condition: trigger
        id:
        - doorOpenOff
      sequence:
      - service: input_boolean.turn_off
        data: {}
        target:
          entity_id: input_boolean.doors_open
  mode: single
- id: '1713181284693'
  alias: Türen Offen Check
  description: ''
  triggers:
  - device_id: 67bc89621a1ceb0aced67ad07618a34b
    domain: hue
    type: short_release
    subtype: 1
    unique_id: f88e3a46-3b79-423c-868f-7ad7944c62bc
    trigger: device
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.urlaubsmodus
      state: 'on'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  actions:
  - wait_template: "{% set fenster = [\n            'binary_sensor.aqara_contact_badezimmer_contact',\n
      \           'binary_sensor.aqara_contact_balkontur_contact',\n            'binary_sensor.aqara_contact_kinderzimmer_contact',\n
      \           'binary_sensor.aqara_contact_wohnungstur_contact',\n            'binary_sensor.aqara_contact_wohnzimmer_contact',\n
      \           'binary_sensor.aqara_contact_schlafzimmer_contact',\n            ]
      %}\n          {% if fenster | select('is_state', 'on') | list | count > 0 %}\n
      \           true\n          {% else %}\n            false\n          {% endif
      %}"
    continue_on_timeout: false
  - if:
    - condition: state
      entity_id: input_boolean.nicht_storen
      state: 'off'
    then:
    - metadata: {}
      data:
        message: Es sieht so aus, als wären noch eine oder mehrere Türen offen. Prüfe
          doch mal nach, welche das sein könnten und schließe sie gegebenenfalls bevor
          du gehst.
        title: Es sind noch Türen offen
      action: notify.home_ai
  - metadata: {}
    data:
      message: Es sieht so aus, als wären noch eine oder mehrere Türen offen. Prüfe
        doch mal nach, welche das sein könnten und schließe sie gegebenenfalls bevor
        du gehst.
    action: notify.alexa_media_echo_flur
    enabled: false
  mode: single
- id: '1713181882652'
  alias: Fenster Offen Check
  description: ''
  triggers:
  - device_id: 67bc89621a1ceb0aced67ad07618a34b
    domain: hue
    type: short_release
    subtype: 2
    unique_id: 8d3f7a5f-3828-4f9f-96c9-fcc402888bfc
    trigger: device
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.urlaubsmodus
      state: 'on'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  actions:
  - wait_template: "{% set fenster = [\n            'binary_sensor.eve_contact_schlafzimmer_fenster_rechts',\n
      \           'binary_sensor.aqara_contact_balkontur_contact'\n            ] %}\n
      \         {% if fenster | select('is_state', 'on') | list | count > 0 %}\n            true\n
      \         {% else %}\n            false\n          {% endif %}"
    continue_on_timeout: false
  - if:
    - condition: state
      entity_id: input_boolean.nicht_storen
      state: 'off'
    then:
    - metadata: {}
      data:
        message: Es sieht so aus, als wären noch eines oder mehrere Fenster offen.
          Prüfe doch mal nach, welche das sein könnten und schließe sie gegebenenfalls
          bevor du gehst.
        title: Es sind noch Fenster offen
      action: notify.home_ai
  - metadata: {}
    data:
      message: Es sieht so aus, als wären noch eines oder mehrere Fenster offen. Prüfe
        doch mal nach, welche das sein könnten und schließe sie gegebenenfalls bevor
        du gehst.
    action: notify.alexa_media_echo_flur
    enabled: false
  mode: single
- id: '1713209575955'
  alias: Run Chores
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /10
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: readme.generate
    data: {}
  - service: shell_command.run_chores
    data: {}
    response_variable: backup_response
  mode: single
- id: database_repack
  alias: System - Database Repack (Weekly)
  description: ''
  trigger:
  - platform: time
    at: 02:00
  condition:
  - condition: and
    conditions:
    - condition: time
      weekday:
      - sun
      - tue
      - thu
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  action:
  - service: recorder.purge
    data:
      apply_filter: true
      repack: true
  mode: single
- id: '1713259440389'
  alias: Dashboard Küche
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.hlk_ld2410_7137_anwesenheit
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 2
    id: hlkKuecheOn
    trigger: state
  - entity_id:
    - binary_sensor.hlk_ld2410_7137_anwesenheit
    from: 'on'
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 3
    id: hlkKuecheOff
    trigger: state
  conditions:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - hlkKuecheOn
      sequence:
      - target:
          device_id: aaa0eae9a416510075db748a0b6262dc
        data:
          is_volume_muted: true
        action: media_player.volume_mute
      - data:
          entity_id: media_player.nest_kuche
          dashboard_path: dashboard-kuche
          view_path: '0'
        action: cast.show_lovelace_view
    - conditions:
      - condition: trigger
        id:
        - hlkKuecheOff
      sequence:
      - target:
          entity_id: media_player.nest_kuche
        data: {}
        action: media_player.turn_off
      - target:
          device_id: aaa0eae9a416510075db748a0b6262dc
        data:
          is_volume_muted: false
        action: media_player.volume_mute
  mode: single
- id: '1713443188220'
  alias: '[Admin] Zigbee2MQTT Restart Nightly'
  description: ''
  trigger:
  - platform: time
    at: 00:00:00
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: script.1699263855216
    metadata: {}
    data: {}
  mode: single
- id: '1713444406391'
  alias: 'Motion: Schlafzimmer Steckdosen An'
  description: ''
  triggers:
  - type: motion
    device_id: 7166fbfe0af7d53d4673741c96c3863d
    entity_id: 94bfc27f3b165fc352e2cc04541190d1
    domain: binary_sensor
    trigger: device
  conditions:
  - condition: and
    conditions:
    - condition: time
      after: '21:00:00'
      weekday:
      - mon
      - fri
      - sat
      - sun
      - tue
      - wed
      - thu
      before: 00:00:00
    - condition: and
      conditions:
      - condition: state
        entity_id: input_boolean.wartung
        state: 'off'
      - condition: state
        entity_id: input_boolean.manuell
        state: 'off'
  actions:
  - if:
    - condition: state
      entity_id: switch.steckdose_bett
      state: 'off'
    - condition: state
      entity_id: switch.steckdose_tv_schlafzimmer
      state: 'off'
    then:
    - parallel:
      - type: turn_on
        device_id: cee4b3caf72c6c64e4cf9115e5ad0c40
        entity_id: 82f42d86b638d5bf6c7b3f54ee19ac1a
        domain: switch
      - type: turn_on
        device_id: 687585a826f140c103f447d4384f11a8
        entity_id: 107487a20fd417d6c27308fc10f3df40
        domain: switch
  mode: single
- id: '1713444564715'
  alias: Steckdosen Schlafzimmer Morgens Aus
  description: ''
  triggers:
  - at: 08:00:00
    trigger: time
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
    - condition: state
      entity_id: input_boolean.manuell
      state: 'off'
  actions:
  - parallel:
    - type: turn_off
      device_id: cee4b3caf72c6c64e4cf9115e5ad0c40
      entity_id: 82f42d86b638d5bf6c7b3f54ee19ac1a
      domain: switch
    - type: turn_off
      device_id: 687585a826f140c103f447d4384f11a8
      entity_id: 107487a20fd417d6c27308fc10f3df40
      domain: switch
  mode: single
- id: '1713448133488'
  alias: Schalter Flur Deckenlicht
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 0bd3a8ef3dbdde3611e8f7f2b0d33f35
    entity_id: e121bb409464ba167ad31f9375490156
    domain: switch
    id: schalterFlurAn
  - platform: device
    type: turned_off
    device_id: 0bd3a8ef3dbdde3611e8f7f2b0d33f35
    entity_id: e121bb409464ba167ad31f9375490156
    domain: switch
    id: schalterFlurAus
  - platform: device
    type: turned_off
    device_id: 4b04528f90d6106276926f279e2d4cb6
    entity_id: 95eab0e0f096de60d69cc6204752c455
    domain: light
    id: deckeFlurAus
  - platform: device
    type: turned_on
    device_id: 4b04528f90d6106276926f279e2d4cb6
    entity_id: 95eab0e0f096de60d69cc6204752c455
    domain: light
    id: deckeFlurAn
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - schalterFlurAn
      sequence:
      - type: turn_on
        device_id: 4b04528f90d6106276926f279e2d4cb6
        entity_id: 95eab0e0f096de60d69cc6204752c455
        domain: light
    - conditions:
      - condition: trigger
        id:
        - schalterFlurAus
      sequence:
      - type: turn_off
        device_id: 4b04528f90d6106276926f279e2d4cb6
        entity_id: 95eab0e0f096de60d69cc6204752c455
        domain: light
    - conditions:
      - condition: trigger
        id:
        - deckeFlurAus
      sequence:
      - service: switch.turn_off
        target:
          entity_id:
          - switch.flur_schalter_decke
        data: {}
    - conditions:
      - condition: trigger
        id:
        - deckeFlurAn
      sequence:
      - service: switch.turn_on
        target:
          entity_id:
          - switch.flur_schalter_decke
        data: {}
  mode: single
- id: '1713785658342'
  alias: ESPHome Auto-Update
  description: ''
  trigger:
  - platform: template
    value_template: '{{ integration_entities(''esphome'') | select(''match'', ''^update.'')
      | select(''is_state'', ''on'') | list | count > 0 }}'
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - type: turn_on
    device_id: ecebaf73a60aa0461a4709ead7d7c698
    entity_id: a4472801d90a581649f903138a92e29c
    domain: switch
  - service: script.esphome_update_all_devices
    metadata: {}
    data: {}
  - delay:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - service: hassio.addon_restart
    data:
      addon: 5c53de3b_esphome
  - delay:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - type: turn_off
    device_id: ecebaf73a60aa0461a4709ead7d7c698
    entity_id: a4472801d90a581649f903138a92e29c
    domain: switch
  mode: single
- id: '1713867813081'
  alias: Starte WELT Livestream morgens
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.presence_couch
    to: 'on'
    from: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 10
    trigger: state
  conditions:
  - condition: and
    conditions:
    - condition: time
      after: 06:00:00
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      before: 09:00:00
    - condition: numeric_state
      entity_id: sensor.people_home
      above: 0
    - condition: state
      entity_id: input_boolean.nachrichten
      state: 'on'
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
    enabled: true
  actions:
  - type: turn_on
    device_id: d30e5e22fdee4494285af01c47713091
    entity_id: 05785b4428b8cdd9ff015195221899c8
    domain: switch
  - metadata: {}
    data: {}
    enabled: true
    action: rest_command.start_welt_stream
  - metadata: {}
    data: {}
    action: script.power_wohnzimmer
  - delay:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - target:
      device_id: 67feb204d2fca3cfd31e143defa33fe5
    data:
      media_content_type: url
      media_content_id: '{{ states(''input_text.latest_welt_stream'') }}'
    action: media_player.play_media
  mode: single
- id: '1713885934064'
  alias: Schalter Flur Nuki
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 0bd3a8ef3dbdde3611e8f7f2b0d33f35
    entity_id: 55c2f5c9869bcfbeac0ed4d2dfbc4567
    domain: switch
    id: nukiAutoUnlockOn
  - platform: device
    type: turned_off
    device_id: 0bd3a8ef3dbdde3611e8f7f2b0d33f35
    entity_id: 55c2f5c9869bcfbeac0ed4d2dfbc4567
    domain: switch
    id: nukiAutoUnlockOff
  - platform: state
    entity_id:
    - switch.nuki_haustur_continuous_mode
    from: 'off'
    to: 'on'
    id: nukiOn
  - platform: state
    entity_id:
    - switch.nuki_haustur_continuous_mode
    from: 'on'
    to: 'off'
    id: nukiOff
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - nukiAutoUnlockOn
      sequence:
      - metadata: {}
        data: {}
        target:
          entity_id:
          - switch.nuki_haustur_continuous_mode
        enabled: true
        action: switch.turn_on
      - metadata: {}
        data:
          message: '{{ [ "Bis gleich!", "Bis gleich dann!", "Sehen uns gleich!", "Gleich
            sehen wir uns!", "Bis gleich, in ein paar Minuten!", "Bis gleich, freue
            mich!", "Bin bald bei dir, bis gleich!", "Wir sehen uns gleich wieder!",
            "Nur noch kurz, bis gleich!", "Bis gleich, nicht weglaufen!", "Bis gleich,
            halte die Stellung!", "Wir treffen uns gleich, bis dahin!", "Bis gleich,
            mach''s gut!", "Bis gleich, ich beeile mich!", "Gleich bin ich zurück,
            bis gleich!", "Sehen uns gleich, halt die Ohren steif!", "Bis gleich,
            lass dich nicht unterkriegen!", "Bis gleich, das wird super!", "Gleich
            sind wir wieder zusammen, bis gleich!", "Bis gleich, ich zähle die Minuten!",
            "Bis gleich, halt alles bereit!", "Bis gleich, ich freu mich schon!" ]
            | random }}'
        action: notify.alexa_media_echo_flur
        enabled: false
    - conditions:
      - condition: trigger
        id:
        - nukiAutoUnlockOff
      sequence:
      - target:
          entity_id:
          - switch.nuki_haustur_continuous_mode
        data: {}
        action: switch.turn_off
      - data:
          message: Auto-Unlock wurde abgeschaltet
        action: notify.alexa_media_echo_flur
        enabled: false
    - conditions:
      - condition: trigger
        id:
        - nukiOn
      sequence:
      - type: turn_on
        device_id: 0bd3a8ef3dbdde3611e8f7f2b0d33f35
        entity_id: 55c2f5c9869bcfbeac0ed4d2dfbc4567
        domain: switch
    - conditions:
      - condition: trigger
        id:
        - nukiOff
      sequence:
      - type: turn_off
        device_id: 0bd3a8ef3dbdde3611e8f7f2b0d33f35
        entity_id: 55c2f5c9869bcfbeac0ed4d2dfbc4567
        domain: switch
  mode: single
- id: '1713900000210'
  alias: Hue Sync Aus
  description: ''
  trigger:
  - platform: device
    device_id: 67feb204d2fca3cfd31e143defa33fe5
    domain: media_player
    entity_id: 65eb5f3b6dea80977e4668301f1db147
    type: turned_off
  - platform: device
    type: turned_off
    device_id: d30e5e22fdee4494285af01c47713091
    entity_id: 05785b4428b8cdd9ff015195221899c8
    domain: switch
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - parallel:
    - service: light.turn_off
      data: {}
      target:
        device_id:
        - 916ac0645e12fe77d93d9731956888e4
        - 8d09b3d2460d7b46609a435e034c3a59
        - 1e74380a353e5af91767df2483e266fe
        - 3d2124b0362a0b5d69b4f905ec8a36c5
        - f1b7043426d3c3b2f515c4c34a06a317
        - 39b956e7b743a4c9e1809961d0342e07
        - 0659143f2b330e1bc3ac9e03bc644351
        - 171cf6e6bd2c823a2a91c916b23b3e25
        - d181c5b405f8f05347e2d47b973e6f11
    - service: switch.turn_off
      target:
        entity_id: switch.sync_box_light_sync
      data: {}
  mode: single
- id: '1713949268424'
  alias: 'Person: Reload'
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /2
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: person.reload
    data: {}
  mode: single
- id: '1715333709045'
  alias: Zigbee2MQTT Offline Devices
  description: ''
  use_blueprint:
    path: Mr-Groch/offline-notification-for-sensors-with-last_seen.yaml
    input:
      actions:
      - service: notify.home_ai
        data:
          message: '{{ sensors }}'
- id: '1715335009101'
  alias: Update all AWTRIX
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.blueforcer_awtrix3_neueste_version
    attribute: tag
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  - service: mqtt.publish
    data:
      topic: awtrix_wohnzimmer/doupdate
  mode: single
- id: '1715336573998'
  alias: 'AWTRIX: Wohnzimmer Instagram Follower'
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /5
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: mqtt.publish
    metadata: {}
    data:
      retain: false
      qos: '0'
      topic: awtrix_wohnzimmer/custom/instagramfollower
      payload: '{"icon": "instagram", "text": "{{ states(''sensor.instagram_api'')}}
        Follower", "duration": 5 }'
  mode: single
- id: '1715341229281'
  alias: 'AWTRIX: Speedtest'
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /10
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: mqtt.publish
    metadata: {}
    data:
      qos: '0'
      retain: false
      topic: awtrix_wohnzimmer/custom/speedtest_down
      payload: '{"text":"Download speed is {{ states.sensor.speedtest_download.state}}  Mbp/s","icon":"download","pushIcon":0,"repeat":1,"textCase":2,"textOffset":33}'
  - service: mqtt.publish
    metadata: {}
    data:
      qos: '0'
      retain: false
      topic: awtrix_wohnzimmer/custom/speedtest_up
      payload: '{"text":"Upload speed is {{ states.sensor.speedtest_upload.state}}  Mbp/s","icon":"upload","pushIcon":0,"repeat":1,"textCase":2,"textOffset":33}'
  mode: single
- id: '1715341461660'
  alias: "Awtrix Spotify NowPlaying \U0001F3B9"
  description: ''
  trigger:
  - platform: state
    entity_id: media_player.spotify_florian
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: media_player.spotify_florian
        state: playing
      - condition: state
        entity_id: media_player.spotify_florian
        attribute: media_content_type
        state: music
      sequence:
      - service: mqtt.publish
        data:
          qos: 0
          retain: false
          payload: "{\n  \"text\": \"{{ state_attr('media_player.spotify_florian',
            'media_artist') }} - {{ state_attr('media_player.spotify_florian', 'media_title')
            }}\",\n  \"icon\": \"647\",\n  \"rainbow\": true,\n  \"repeat\": 2,\n
            \ \"pushIcon\": 0,\n  \"textCase\": 0,\n  \"textOffset\": 15,\n  \"progress\":
            {{ ( states.media_player.spotify_florian.attributes.media_position / states.media_player.spotify_florian.attributes.media_duration
            * 100 ) | round() }},\n  \"progressC\": \"18B04C\"\n}"
          topic: awtrix_wohnzimmer/custom/spotify
    - conditions:
      - condition: template
        value_template: '{{ not states.media_player.spotify_florian.state == ''playing''
          }}'
      sequence:
      - service: mqtt.publish
        data:
          qos: 0
          retain: false
          topic: awtrix_wohnzimmer/custom/spotify
- id: 90a76832-88a6-4da3-94f6-975154c297ff
  alias: Update OpenUV every 59 minutes during the daytime
  description: ''
  trigger:
  - minutes: 59
    platform: time_pattern
  condition:
  - condition: and
    conditions:
    - after: sunrise
      before: sunset
      condition: sun
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  action:
  - service: homeassistant.update_entity
    data: {}
    target:
      entity_id:
      - sensor.openuv_aktueller_uv_index
      - binary_sensor.openuv_schutzfenster
- id: '1716151253982'
  alias: 'OpenUV: Reload'
  description: ''
  trigger:
  - platform: time_pattern
    hours: /12
  condition:
  - condition: and
    conditions:
    - after: sunrise
      before: sunset
      condition: sun
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
  action:
  - service: homeassistant.update_entity
    target:
      entity_id:
      - binary_sensor.openuv_schutzfenster
      - sensor.openuv_aktueller_uv_index
      - sensor.openuv_aktueller_uv_wert
    data: {}
  mode: single
- id: '1716668889277'
  alias: Toggle Abend / Morgen
  description: ''
  trigger:
  - platform: time
    at: '20:00:00'
    id: eveningOn
  - platform: time
    at: 06:00:00
    id: eveningOff
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - eveningOn
      sequence:
      - service: input_boolean.turn_on
        target:
          entity_id: input_boolean.abend
        data: {}
    - conditions:
      - condition: trigger
        id:
        - eveningOff
      sequence:
      - service: input_boolean.turn_off
        target:
          entity_id: input_boolean.abend
        data: {}
  mode: single
- id: '1717147815711'
  alias: '[Zigbee2MQTT] Enable Z2M Join'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.z2m_permit_join
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: mqtt.publish
    data:
      topic: zigbee2mqtt/bridge/config/permit_join
      payload: 'true'
  - service: timer.start
    data:
      entity_id: timer.z2m_permit_join
- id: '1717147845731'
  alias: '[Zigbee2MQTT] Disable Z2M Join'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.z2m_permit_join
    to: 'off'
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: mqtt.publish
    data:
      topic: zigbee2mqtt/bridge/config/permit_join
      payload: 'false'
  - service: timer.cancel
    data:
      entity_id: timer.z2m_permit_join
- id: '1718549422662'
  alias: '[NFC Tag] Staubsauger Wassertank'
  description: ''
  trigger:
  - platform: tag
    tag_id: staubsauger_wassertank
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.staubsauger_wassertank
  mode: single
- id: '1718562692032'
  alias: '[NFC Tag] Staubsauger Wassertank nachgefüllt'
  description: ''
  trigger:
  - platform: tag
    tag_id: staubsauger_wassertank
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: input_datetime.set_datetime
    target:
      entity_id: input_datetime.wassertank_aufgefullt
    data:
      date: '{{ states(''sensor.date'') }}'
  mode: single
- id: '1718565264616'
  alias: Klo Besetzt
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.aqara_vibrate_katzenklo_angle_y
    id: kloAn
    below: -5
  - platform: numeric_state
    entity_id:
    - sensor.aqara_vibrate_katzenklo_angle_y
    id: kloAus
    above: -5
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - kloAn
      sequence:
      - service: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.klo_besetzt
      - service: counter.increment
        metadata: {}
        data: {}
        target:
          entity_id: counter.toiletten_sitzungen
    - conditions:
      - condition: trigger
        id:
        - kloAus
      sequence:
      - service: input_boolean.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.klo_besetzt
  mode: single
- id: '1718614598599'
  alias: Process and Notify
  description: ''
  triggers:
  - event_type: call_service
    event_data:
      domain: notify
      service: home_ai
    trigger: event
  conditions:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  actions:
  - metadata: {}
    data:
      text: 'Briefly tell me that my {{ trigger.event.data.service_data.message }}.
        Always make sure that the message fits into 2 sentences.

        '
      agent_id: conversation.chatgpt_assist
      language: german
    response_variable: generated_response
    action: conversation.process
  - if:
    - condition: template
      value_template: '{{ trigger.event.data.service_data.data.actions != null }}'
    then:
    - metadata: {}
      data:
        message: '{{ generated_response.response.speech.plain.speech }}'
        title: '{{ trigger.event.data.service_data.title }}'
        data:
          actions: '{{ trigger.event.data.service_data.data.actions }}'
      action: notify.florian_notify
    else:
    - metadata: {}
      data:
        message: '{{ generated_response.response.speech.plain.speech }}'
        title: '{{ trigger.event.data.service_data.title }}'
      action: notify.florian_notify
  mode: single
- id: '1719174034446'
  alias: Wohnzimmer Licht wenn zu dunkel
  description: ''
  triggers:
  - entity_id:
    - sensor.mi_light_sensor_wohnzimmer_illuminance
    below: 30
    trigger: numeric_state
  conditions:
  - condition: and
    conditions:
    - condition: numeric_state
      entity_id: sensor.people_home
      above: 0
    - condition: state
      entity_id: remote.appletv_wohnzimmer
      state: 'on'
    - condition: sun
      after: sunset
    - condition: time
      before: '23:00:00'
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
      after: '17:00:00'
    - condition: and
      conditions:
      - condition: state
        entity_id: input_boolean.wartung
        state: 'off'
      - condition: state
        entity_id: input_boolean.manuell
        state: 'off'
  actions:
  - metadata: {}
    data: {}
    target:
      device_id:
      - 8d09b3d2460d7b46609a435e034c3a59
      - 916ac0645e12fe77d93d9731956888e4
      - 1e74380a353e5af91767df2483e266fe
      - 171cf6e6bd2c823a2a91c916b23b3e25
      - 3d2124b0362a0b5d69b4f905ec8a36c5
    action: light.turn_on
  mode: single
- id: '1719501882967'
  alias: Restart Nightly
  description: ''
  trigger:
  - platform: time
    at: 04:00:00
  condition:
  - condition: state
    entity_id: input_boolean.wartung
    state: 'off'
  action:
  - service: hassio.host_reboot
    data: {}
  - delay:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - service: homeassistant.reload_all
    data: {}
  mode: single
- id: '1720118766760'
  alias: Taster Wohnzimmer Laustärke Sonos Ray
  description: ''
  use_blueprint:
    path: EPMatt/ikea_e1766.yaml
    input:
      integration: Zigbee2MQTT
      controller_device: f26bff9b79e4740036fe7b46bb3ed1d0
      controller_entity: sensor.ikea_taster_fensterbank_wohnzimmer_action
      helper_last_controller_event: input_text.last_controller
      action_button_up_short:
      - if:
        - condition: state
          entity_id: input_boolean.wartung
          state: 'off'
        then:
        - service: media_player.volume_up
          target:
            device_id: 9d14dca47a5773d55c5f7f9d16c58476
          data: {}
      action_button_up_release: []
      action_button_down_short:
      - if:
        - condition: state
          entity_id: input_boolean.wartung
          state: 'off'
        then:
        - service: media_player.volume_down
          target:
            device_id:
            - 9d14dca47a5773d55c5f7f9d16c58476
          data: {}
      action_button_up_double: []
      button_up_double_press: false
      button_down_double_press: false
      helper_double_press_delay: 500
- id: '1726224334152'
  alias: Balkontür Rollo Öffnen
  description: ''
  trigger:
  - platform: state
    entity_id:
    - cover.ikea_rollo_balkontur
    to: opening
  condition:
  - condition: state
    entity_id: binary_sensor.aqara_contact_balkontur_contact
    state: 'on'
  action:
  - action: cover.close_cover
    target:
      entity_id: cover.ikea_rollo_balkontur
    data: {}
  mode: single
- id: '1726234446658'
  alias: Heizung Kontrolle
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.aqara_contact_balkontur_contact
    to: 'on'
    id: balkonDoorOpen
  - platform: state
    entity_id:
    - binary_sensor.aqara_contact_balkontur_contact
    to: 'on'
    id: balkonDoorClosed
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - balkonDoorOpen
      sequence:
      - if:
        - condition: state
          entity_id: climate.eve_heizung_wohnzimmer
          state: heat
        then:
        - device_id: b4caf944bee99395e23b319efe0618b7
          domain: climate
          entity_id: 163bf4ce33a250745098a4632c52a7e3
          type: set_hvac_mode
          hvac_mode: 'off'
    - conditions:
      - condition: trigger
        id:
        - balkonDoorClosed
      sequence:
      - if:
        - condition: state
          entity_id: climate.eve_heizung_wohnzimmer
          state: 'off'
        then:
        - device_id: b4caf944bee99395e23b319efe0618b7
          domain: climate
          entity_id: 163bf4ce33a250745098a4632c52a7e3
          type: set_hvac_mode
          hvac_mode: heat
  mode: single
- id: '1726392490651'
  alias: Luftreiniger nach Qualität
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.luftreiniger_wohnzimmer_pm2_5
    id: wohnzimmerAQIBad
    to: bad
  - platform: state
    entity_id:
    - sensor.luftreiniger_wohnzimmer_pm2_5
    id: wohnzimmerAQIModerate
    to: moderate
  - platform: state
    entity_id:
    - sensor.luftreiniger_schlafzimmer_pm2_5
    id: schlafzimmerAQIBad
    to: bad
  - platform: state
    entity_id:
    - sensor.luftreiniger_schlafzimmer_pm2_5
    id: schlafzimmerAQIModerate
    to: moderate
  condition:
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
    - sun
    before: '21:00:00'
    after: 08:00:00
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - wohnzimmerAQIBad
      sequence:
      - data:
          fan_mode: high
        target:
          entity_id: climate.luftreiniger_schlafzimmer
        action: climate.set_fan_mode
      - delay:
          hours: 0
          minutes: 15
          seconds: 0
          milliseconds: 0
      - data:
          fan_mode: low
        target:
          entity_id:
          - climate.luftreiniger_schlafzimmer
        action: climate.set_fan_mode
    - conditions:
      - condition: trigger
        id:
        - wohnzimmerAQIModerate
      sequence:
      - data:
          fan_mode: high
        target:
          entity_id: climate.luftreiniger_schlafzimmer
        action: climate.set_fan_mode
      - delay:
          hours: 0
          minutes: 10
          seconds: 0
          milliseconds: 0
      - data:
          fan_mode: low
        target:
          entity_id:
          - climate.luftreiniger_schlafzimmer
        action: climate.set_fan_mode
    - conditions:
      - condition: trigger
        id:
        - schlafzimmerAQIBad
      sequence:
      - data:
          fan_mode: high
        target:
          entity_id:
          - climate.luftreiniger_wohnzimmer
        action: climate.set_fan_mode
      - delay:
          hours: 0
          minutes: 10
          seconds: 0
          milliseconds: 0
      - data:
          fan_mode: low
        target:
          entity_id:
          - climate.luftreiniger_wohnzimmer
        action: climate.set_fan_mode
    - conditions:
      - condition: trigger
        id:
        - schlafzimmerAQIModerate
      sequence:
      - data:
          fan_mode: high
        target:
          entity_id:
          - climate.luftreiniger_wohnzimmer
        action: climate.set_fan_mode
      - delay:
          hours: 0
          minutes: 10
          seconds: 0
          milliseconds: 0
      - data:
          fan_mode: low
        target:
          entity_id:
          - climate.luftreiniger_wohnzimmer
        action: climate.set_fan_mode
  mode: single
- id: '1727982759887'
  alias: IKEA Stybar Silber Wohnzimmer
  description: ''
  use_blueprint:
    path: EPMatt/ikea_e2001_e2002.yaml
    input:
      integration: Zigbee2MQTT
      controller_entity: sensor.ikea_stybar_silber_wohnzimmer_action
      action_button_left_short:
      - action: media_player.volume_down
        target:
          device_id:
          - 9d14dca47a5773d55c5f7f9d16c58476
          - 769df0e4eb3df0faa38fb2311aa42623
        data: {}
      action_button_right_short:
      - action: media_player.volume_up
        target:
          device_id:
          - 9d14dca47a5773d55c5f7f9d16c58476
          - 769df0e4eb3df0faa38fb2311aa42623
        data: {}
      action_button_left_long:
      - action: media_player.media_stop
        target:
          entity_id:
          - media_player.sonos_wohnzimmer
        data: {}
      helper_last_controller_event: input_text.last_controller
      action_button_up_short:
      - action: cover.open_cover
        target:
          device_id:
          - 2c6903e160b7b9dfaf222a7360bc0015
          - 5556afe8383ee4a45f5b74e6cc1d57ee
        data: {}
      action_button_down_short:
      - action: cover.close_cover
        target:
          device_id:
          - 2c6903e160b7b9dfaf222a7360bc0015
          - 5556afe8383ee4a45f5b74e6cc1d57ee
        data: {}
      action_button_right_long:
      - action: mass.play_media
        target:
          device_id: 769df0e4eb3df0faa38fb2311aa42623
        data:
          media_id: spotify://playlist/37i9dQZF1E37gOCuPARKby
          radio_mode: true
          media_type: playlist
      action_button_left_double: []
      action_button_right_double: []
- id: '1727983178880'
  alias: IKEA Stybar Weiss Schlafzimmer
  description: ''
  use_blueprint:
    path: EPMatt/ikea_e2001_e2002.yaml
    input:
      integration: Zigbee2MQTT
      controller_entity: sensor.ikea_stybar_weiss_schlafzimmer_action
- id: '1727983565081'
  alias: IKEA Rodret Optional
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: IKEA Rodret Optional
- id: '1728284886485'
  alias: Home Assistant Auto-update on a schedule base
  description: ''
  use_blueprint:
    path: edwardtfn/auto_update_scheduled.yaml
    input:
      schedule_entity: schedule.updates
      restart_type: core
- id: '1728905439373'
  alias: Couch
  description: ''
  triggers:
  - type: not_occupied
    device_id: 779a3e27762696ab42d6562bf3501934
    entity_id: fc3bf20b4daf944d19c71e62a29723f8
    domain: binary_sensor
    trigger: device
    id: couchFrei
  - type: occupied
    device_id: 779a3e27762696ab42d6562bf3501934
    entity_id: fc3bf20b4daf944d19c71e62a29723f8
    domain: binary_sensor
    trigger: device
    id: couchBelegt
  conditions:
  - condition: and
    conditions:
    - condition: numeric_state
      entity_id: sensor.people_home
      above: 0
    - condition: state
      entity_id: input_boolean.movietime
      state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - couchFrei
      sequence:
      - action: media_player.media_pause
        metadata: {}
        data: {}
        target:
          device_id: 67feb204d2fca3cfd31e143defa33fe5
    - conditions:
      - condition: trigger
        id:
        - couchBelegt
      sequence:
      - action: remote.send_command
        metadata: {}
        data:
          command: play
        target:
          device_id: 67feb204d2fca3cfd31e143defa33fe5
  mode: single
- id: '1729247777105'
  alias: Rollos Schlafzimmer
  description: ''
  triggers:
  - trigger: time
    at: '21:00:00'
    id: coverCloseSchlafzimmer
  - trigger: time
    at: 08:30:00
    id: coverOpenSchlafzimmer
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
    - condition: state
      entity_id: input_boolean.manuell
      state: 'off'
    - condition: state
      entity_id: input_boolean.rollos_schlafzimmer
      state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - coverCloseSchlafzimmer
      sequence:
      - action: cover.close_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.rollos_schlafzimmer
    - conditions:
      - condition: trigger
        id:
        - coverOpenSchlafzimmer
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.rollos_schlafzimmer
  mode: single
- id: '1729514153134'
  alias: Serverschrank Fan Controller
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.glances_proxmox_pve_01_core_temperatur
    for:
      hours: 0
      minutes: 5
      seconds: 0
    above: 250
    id: coreTempOn
  - trigger: numeric_state
    entity_id:
    - sensor.glances_proxmox_pve_01_core_temperatur
    for:
      hours: 0
      minutes: 5
      seconds: 0
    id: coreTempOff
    below: 250
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - coreTempOn
      sequence:
      - action: switch.turn_on
        metadata: {}
        data: {}
        target:
          device_id: 4bd2421af39cbb87537914ffe272415d
    - conditions:
      - condition: trigger
        id:
        - coreTempOff
      sequence:
      - action: switch.turn_off
        target:
          device_id:
          - 4bd2421af39cbb87537914ffe272415d
        data: {}
  mode: single
- id: '1730139795585'
  alias: Bambu Lab A1 Image Reload
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - sensor.bambu_lab_a1_aktueller_arbeitsschritt
    to: printing
  conditions: []
  actions:
  - action: homeassistant.update_entity
    data:
      entity_id:
      - image.bambu_lab_a1_titelbild
  mode: single
- id: '1731317783562'
  alias: Battery Low Notification
  description: Battery Low Notification with auto dismiss
  triggers:
  - event_type: battery_notes_battery_threshold
    event_data:
      battery_low: true
    id: low
    alias: Battery went low
    trigger: event
  - event_type: battery_notes_battery_threshold
    event_data:
      battery_low: false
    id: high
    alias: Battery went high
    trigger: event
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - low
      sequence:
      - data:
          title: '{{ trigger.event.data.device_name }} Battery Low

            '
          notification_id: '{{ trigger.event.data.device_id }}-{{ trigger.event.data.source_entity_id
            }}'
          message: 'The device has a battery level of {{ trigger.event.data.battery_level
            }}% {{ ''\n'' -}} You need {{ trigger.event.data.battery_quantity }}×
            {{ trigger.event.data.battery_type }}

            '
        action: persistent_notification.create
    - conditions:
      - condition: trigger
        id:
        - high
      sequence:
      - data:
          notification_id: '{{ trigger.event.data.device_id }}-{{ trigger.event.data.source_entity_id
            }}'
        action: persistent_notification.dismiss
  mode: queued
- id: '1731317900823'
  alias: Battery Replaced
  description: Battery Replaced
  triggers:
  - event_type: battery_notes_battery_increased
    trigger: event
  conditions: []
  actions:
  - data:
      device_id: '{{ trigger.event.data.device_id }}'
      source_entity_id: '{{ trigger.event.data.source_entity_id }}'
    action: battery_notes.set_battery_replaced
  mode: queued
- id: '1732381912698'
  alias: Bambulab AWTRIX 3 Printer Assistant
  description: ''
  use_blueprint:
    path: blueforcer/flow_R0ZVOjYYorGl.yaml
    input:
      awtrix:
      - 472e344dea5aa2229f4b915e90e2c141
      sensor_bed_temperature: sensor.bambu_lab_a1_druckbetttemperatur
      sensor_target_bed_temperature: number.bambu_lab_a1_zieltemperatur_des_druckbett
      sensor_nozzle_temperature: sensor.bambu_lab_a1_temperatur_der_duse
      sensor_nozzle_target_temperature: number.bambu_lab_a1_zieltemperatur_der_duse
      sensor_print_progress: sensor.bambu_lab_a1_druckfortschritt
      sensor_current_layer: sensor.bambu_lab_a1_aktuelle_schicht
      sensor_remaining_time: sensor.bambu_lab_a1_verbleibende_zeit
      sensor_total_layer_count: sensor.bambu_lab_a1_gesamtzahl_der_schichten
      sensor_task_name: sensor.bambu_lab_a1_name_der_aufgabe
      sensor_print_status: sensor.bambu_lab_a1_druckstatus
      sensor_current_stage: sensor.bambu_lab_a1_aktueller_arbeitsschritt
- id: '1732451636104'
  alias: Awtrix current playing song
  description: ''
  use_blueprint:
    path: blueforcer/flow_GKXydoDmOpjL.yaml
    input:
      awtrix_3: 472e344dea5aa2229f4b915e90e2c141
      media_player: media_player.spotifyplus_florian
- id: '1732616821280'
  alias: AI Event Summary (LLM Vision v1.3.1)
  description: ''
  use_blueprint:
    path: valentinfrlch/event_summary.yaml
    input:
      notify_device:
      - 243c451777aeeaa0a9568cf5b35f5815
      camera_entities:
      - camera.kamera_flur
      motion_sensors:
      - binary_sensor.aqara_contact_wohnungstur_contact
      model: gemini-1.5-flash-latest
      provider: 01JDKZXB9EHRC39AT0ZFSCEXA7
      mode: Camera
      message: 'Summarize what''s happening in the camera feed (one sentence max).
        Don''t describe the scene! If there is a person, describe what they''re doing
        and what they look like. If they look like a courier mention that! If nothing
        is happening, say so.


        All in german please.'
      preview_mode: Snapshot
- id: '1737626947619'
  alias: Meeting
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.macbook_pro_von_florian_ontracon_camera_in_use
    from: 'off'
    to: 'on'
    id: meetingOn
  - trigger: state
    entity_id:
    - binary_sensor.macbook_pro_von_florian_ontracon_camera_in_use
    from: 'on'
    to: 'off'
    id: meetingOff
  conditions:
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    after: 08:00:00
    before: '17:00:00'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - meetingOn
      sequence:
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.meeting
    - conditions:
      - condition: trigger
        id:
        - meetingOff
      sequence:
      - action: input_boolean.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.meeting
  mode: single
- id: '1737627220636'
  alias: Meeting Toggle
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.meeting
    from: 'off'
    to: 'on'
    id: meetingToggleOn
  - trigger: state
    entity_id:
    - input_boolean.meeting
    from: 'on'
    to: 'off'
    id: meetingToggleOff
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - meetingToggleOn
      sequence:
      - action: notify.mobile_app_pixel_9
        data:
          message: command_dnd
          data:
            command: total_silence
    - conditions:
      - condition: trigger
        id:
        - meetingToggleOff
      sequence:
      - action: notify.mobile_app_pixel_9
        data:
          message: command_dnd
          data:
            command: 'off'
  mode: single
- id: '1739707464405'
  alias: Music Assistant - (nur) lokale Sprachsteuerung - Blueprint
  description: ''
  use_blueprint:
    path: music-assistant/mass_assist_blueprint_de.yaml
    input:
      default_player_entity_id_input: media_player.sonos_wohnzimmer
- id: '1739751430350'
  alias: Aktuelles Handy von Florian
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - input_select.alles_handy_von_florian
    from: iPhone
    to: Pixel 9
    id: iPhoneToPixel
  - trigger: state
    entity_id:
    - input_select.alles_handy_von_florian
    from: Pixel 9
    to: iPhone
    id: pixelToIphone
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - iPhoneToPixel
      sequence:
      - action: input_text.set_value
        metadata: {}
        data:
          value: device_tracker.pixel_9
        target:
          entity_id: input_text.florian_handy
    - conditions:
      - condition: trigger
        id:
        - pixelToIphone
      sequence:
      - action: input_text.set_value
        metadata: {}
        data:
          value: device_tracker.iphone_von_florian
        target:
          entity_id: input_text.florian_handy
  mode: single
- id: '1739922705305'
  alias: Licht Büro An/Aus
  description: ''
  triggers:
  - type: motion
    device_id: 4c197550e4dbe59f91927b89f482e4d4
    entity_id: 626bf75a2265e9e869c442cd8b9e083c
    domain: binary_sensor
    metadata:
      secondary: false
    trigger: device
    id: buroWaveOn
  - type: no_motion
    device_id: 4c197550e4dbe59f91927b89f482e4d4
    entity_id: 626bf75a2265e9e869c442cd8b9e083c
    domain: binary_sensor
    trigger: device
    id: buroWaveOff
    for:
      hours: 0
      minutes: 0
      seconds: 10
  conditions:
  - condition: numeric_state
    entity_id: sensor.mi_light_sensor_kuche_illuminance
    below: 30
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - buroWaveOn
      sequence:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          device_id: 974ca6245b3f8c8fbd28620c1275ef85
    - conditions:
      - condition: trigger
        id:
        - buroWaveOff
      sequence:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          device_id: 974ca6245b3f8c8fbd28620c1275ef85
  mode: single
- id: '1739969686639'
  alias: Wohnzimmer Reinigen
  description: ''
  triggers:
  - trigger: conversation
    command:
    - Reinige das Wohnzimmer
    - Schicke den Staubsauger ins Wohnzimmer
    - Wohnzimmer reinigen
  conditions: []
  actions:
  - action: script.staubsauger_wohnzimmer_reinigen
    metadata: {}
    data: {}
  mode: single
- id: '1739969760920'
  alias: Schlafzimmer Reinigen
  description: ''
  triggers:
  - trigger: conversation
    command:
    - Reinige das Schlafzimmer
    - Schicke den Staubsauger ins Schlafzimmer
    - Schlafzimmer reinigen
  conditions: []
  actions:
  - action: script.staubsauger_schlafzimmer_reinigen
    metadata: {}
    data: {}
  mode: single
- id: '1739969874565'
  alias: Kinderzimmer Reinigen
  description: ''
  triggers:
  - trigger: conversation
    command:
    - Reinige das Kinderzimmer
    - Reinige das Büro
    - Schicke den Staubsauger ins Kinderzimmer
    - Schicke den Staubsauger ins Büro
    - Kinderzimmer reinigen
    - Büro reinigen
  conditions: []
  actions:
  - action: script.staubsauger_buro_reinigen
    metadata: {}
    data: {}
  mode: single
- id: '1739969924503'
  alias: Flur Reinigen
  description: ''
  triggers:
  - trigger: conversation
    command:
    - Reinige den Flur
    - Reinige den Flur
    - Schicke den Staubsauger in den Flur
  conditions: []
  actions:
  - action: script.staubsauger_flur_reinigen
    metadata: {}
    data: {}
  mode: single
- id: '1739969970217'
  alias: Badezimmer Reinigen
  description: ''
  triggers:
  - trigger: conversation
    command:
    - Reinige das Badezimmer
    - Reinige das Bad
    - Schicke den Staubsauger ins Badezimmer
    - Schicke den Staubsauger ins Bad
  conditions: []
  actions:
  - action: script.staubsauger_badezimmer_reinigen
    metadata: {}
    data: {}
  mode: single
- id: '1739970032316'
  alias: Küche Reinigen
  description: ''
  triggers:
  - trigger: conversation
    command:
    - Reinige die Küche
    - Schicke den Staubsauger in die Küche
    - Küche reinigen
  conditions: []
  actions:
  - action: script.staubsauger_kuche_reinigen
    metadata: {}
    data: {}
  mode: single
- id: '1740091713939'
  alias: Rollos Wohnzimmer
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.mi_light_sensor_wohnzimmer_illuminance
    for:
      hours: 0
      minutes: 3
      seconds: 0
    above: 1000
    id: wohnzimmerHellAn
  - trigger: numeric_state
    entity_id:
    - sensor.mi_light_sensor_wohnzimmer_illuminance
    for:
      hours: 0
      minutes: 5
      seconds: 0
    id: wohnzimmerHellAus
    below: 300
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.wartung
      state: 'off'
    - condition: state
      entity_id: input_boolean.manuell
      state: 'off'
    - condition: state
      entity_id: input_boolean.rollos_wohnzimmer
      state: 'off'
    - condition: numeric_state
      entity_id: sensor.people_home
      above: 0
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - wohnzimmerHellAn
      sequence:
      - action: cover.close_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.rollos_wohnzimmer_fensterbank
    - conditions:
      - condition: trigger
        id:
        - wohnzimmerHellAus
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.rollos_wohnzimmer_fensterbank
  mode: single
